<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Line Memorization</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <h1>Memorize Your Lines</h1>
  <input type="file" id="upload" accept=".txt">
  <select id="character-select">
    <option value="">Select Your Character</option>
  </select>
  <div id="script-display"></div>

  <script>
    const uploadInput = document.getElementById('upload');
    const characterSelect = document.getElementById('character-select');
    const scriptDisplay = document.getElementById('script-display');
    let scriptData = {};

    // Handle File Upload
    uploadInput.addEventListener('change', (event) => {
      const file = event.target.files[0];
      const reader = new FileReader();

      reader.onload = () => {
        const lines = reader.result.split('\n');
        scriptData = {};
        lines.forEach(line => {
          const [character, ...dialogue] = line.split(':');
          if (character && dialogue.length) {
            if (!scriptData[character.trim()]) scriptData[character.trim()] = [];
            scriptData[character.trim()].push(dialogue.join(':').trim());
          }
        });

        populateCharacters();
      };

      reader.readAsText(file);
    });

    // Populate Character Dropdown
    function populateCharacters() {
      characterSelect.innerHTML = '<option value="">Select Your Character</option>';
      Object.keys(scriptData).forEach(character => {
        const option = document.createElement('option');
        option.value = character;
        option.textContent = character;
        characterSelect.appendChild(option);
      });
    }

    // Display Script with Filtering
    characterSelect.addEventListener('change', () => {
      const selectedCharacter = characterSelect.value;
      scriptDisplay.innerHTML = '';

      Object.entries(scriptData).forEach(([character, lines]) => {
        lines.forEach(line => {
          const lineElement = document.createElement('div');
          lineElement.textContent = `${character}: ${line}`;
          if (character === selectedCharacter) lineElement.classList.add('hidden');
          scriptDisplay.appendChild(lineElement);
        });
      });
    });
  </script>
</body>
</html>
